generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model User {
    id             Int             @id @default(autoincrement())
    login          String          @unique @db.VarChar(64)
    name           String          @db.VarChar(64)
    password       String          @db.VarChar(64)
    categoryTags   CategoryTag[]
    categoryGroups CategoryGroup[]
}

model CategoryTag {
    id     Int                @id @default(autoincrement())
    name   String             @unique @db.VarChar(256)
    user   User               @relation(fields: [userId], references: [id])
    groups  CategoryTagGroup[]
    userId Int
}

model CategoryGroup {
    id     Int                @id @default(autoincrement())
    name   String             @unique @db.VarChar(256)
    budget Float              @default(0)
    user   User               @relation(fields: [userId], references: [id])
    tags  CategoryTagGroup[]
    userId Int
}

model CategoryTagGroup {
    id      Int           @id @default(autoincrement())
    tag     CategoryTag   @relation(references: [id], fields: [tagId], onDelete: Cascade, onUpdate: Cascade)
    group   CategoryGroup @relation(references: [id], fields: [groupId], onDelete: Cascade, onUpdate: Cascade)
    tagId   Int
    groupId Int

    @@unique([tagId, groupId])
}
