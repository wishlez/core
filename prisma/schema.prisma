generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model User {
    id            Int             @id @default(autoincrement())
    login         String          @unique @db.VarChar(64)
    name          String          @db.VarChar(64)
    password      String          @db.VarChar(64)
    Category      Category[]
    CategoryGroup CategoryGroup[]
}

model Category {
    id     Int                 @id @default(autoincrement())
    name   String              @unique @db.VarChar(256)
    user   User                @relation(fields: [userId], references: [id])
    groups CategoriesInGroup[]
    userId Int
}

model CategoryGroup {
    id         Int                 @id @default(autoincrement())
    name       String              @unique @db.VarChar(256)
    budget     Float               @default(0)
    user       User                @relation(fields: [userId], references: [id])
    categories CategoriesInGroup[]
    userId     Int
}

model CategoriesInGroup {
    id         Int           @id @default(autoincrement())
    category   Category      @relation(references: [id], fields: [categoryId], onDelete: Cascade, onUpdate: Cascade)
    group      CategoryGroup @relation(references: [id], fields: [groupId], onDelete: Cascade, onUpdate: Cascade)
    categoryId Int
    groupId    Int

    @@unique([categoryId, groupId])
}
